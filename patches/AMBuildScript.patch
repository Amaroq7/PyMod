--- AMBuildScript	2020-09-10 01:36:16.602652000 +0200
+++ AMBuildScript-libc++	2020-09-10 01:35:20.336178674 +0200
@@ -97,8 +97,10 @@
         '-Wno-overloaded-virtual',
       ]
 
-      if have_gcc and cxx.target.arch in ['x86', 'x86_64']:
-        cxx.cflags += ['-mfpmath=sse']
+      if have_gcc:
+        if cxx.target.arch in ['x86', 'x86_64']:
+          cxx.cflags += ['-mfpmath=sse']
+        cxx.cxxflags += ['-Wformat-truncation=0']
 
       cxx.postlink += ['-lm']
 
@@ -183,6 +185,19 @@
     # Platform-specifics
     if not cxx.like('emscripten'):
       if cxx.target.platform == 'linux':
+        if have_clang and getattr(builder.options, 'dynamic', False):
+          cxx.linkflags.remove('-lstdc++')
+          cxx.cxxflags += ['-stdlib=libc++']
+          cxx.linkflags += ['-fuse-ld=<LLD>', '--rtlib=compiler-rt', '-Wl,--as-needed']
+          cxx.postlink += ['-L<LLVM_LIBS_DIR>', '-lc++', '-lc++abi', '-lunwind']
+        elif have_clang:
+          cxx.linkflags.remove('-lstdc++')
+          cxx.cxxflags += ['-stdlib=libc++']
+          cxx.linkflags += ['-fuse-ld=<LLD>', '--rtlib=compiler-rt', '-Wl,--as-needed']
+          cxx.postlink += ['-L<LLVM_LIBS_DIR>', '-l:libc++.a', '-l:libc++abi.a', '-l:libunwind.a']
+        elif have_gcc and not getattr(builder.options, 'dynamic', False):
+          cxx.linkflags.remove('-lstdc++')
+          cxx.linkflags += ['-static-libgcc', '-static-libstdc++']
         cxx.postlink += ['-lpthread', '-lrt']
       elif cxx.target.platform == 'mac':
         cxx.linkflags.remove('-lstdc++')
